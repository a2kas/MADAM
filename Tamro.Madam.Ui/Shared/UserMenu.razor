@using Tamro.Madam.Ui.Store.State;
@using Fluxor.Blazor.Web.Components;

@inherits FluxorComponent

<MudTooltip Arrow="true" Text="User profile">
    <MudMenu AnchorOrigin="Origin.BottomRight"
            Color="Color.Tertiary"
             Icon="@Icons.Material.Filled.PermIdentity"
             Class="mx-1"
             LockScroll="true"
             TransformOrigin="Origin.TopRight">
        <ChildContent>
            <div class="pb-4"
                 style="min-width: 260px;margin-bottom:0px!important">
                <MudStack Row="true" Class="ma-4">
                    @if (IsLoading)
                    {
                        <MudProgressCircular Size="Size.Small" Color="Color.Default" Indeterminate="true" />
                    }
                    else
                    {
                        <MudAvatar Color="Color.Primary">
                            @GetInitials(UserProfile?.DisplayName)
                        </MudAvatar>
                    }
                    <MudStack Justify="Justify.SpaceBetween" Spacing="0">
                        <MudText Typo="Typo.h6">@UserProfile?.DisplayName</MudText>
                    </MudStack>
                </MudStack>

                <MudDivider Class="my-2" />
                @{
                    string settingsLink = "/settings";
                    <MudMenuItem OnClick="() => _navigationManager.NavigateTo(settingsLink)">
                    <div class="d-flex">
                        <MudIcon Class="mx-2"
                                 Icon="@Icons.Material.Filled.Settings" />
                        <MudText>Settings</MudText>
                    </div>
                </MudMenuItem>
                }
                <div class="mt-4 mx-4">
                    <MudButton Color="Color.Default"
                               FullWidth="true"
                               StartIcon="@Icons.Material.Filled.Logout"
                               OnClick="OnLogout"
                               Variant="Variant.Outlined">
                        Log out
                    </MudButton>
                </div>
            </div>
        </ChildContent>
    </MudMenu>
</MudTooltip>